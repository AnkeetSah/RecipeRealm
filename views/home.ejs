<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recipe App</title>
    <link rel="icon" type="image/png" href="./images/appLogo/fav.png">
   <link rel="stylesheet" href="/css/header.css">
   <link rel="stylesheet" href="/css/home/randomCard.css">
   <link rel="stylesheet" href="/css/home/hero.css">
   <link rel="stylesheet" href="/css/home/countries.css">

    <style>
      /* Reset some default browser styles */
      body, h1, p, ul, li, a {
        margin: 0;
        padding: 0;
        list-style: none;
        text-decoration: none;
        box-sizing: border-box;
      }
    
      /* General body styling */
      body {
        font-family: Arial, sans-serif;
        color: #fff;
        margin-top: 70px;
        background-color: #000;
      }
    
      
    
      /* Main section styling */
      main {
        padding: 40px 20px;
        background-color: #111;
      }
    
      main .cuisines {
        font-size: 36px;
        color: #32cd32;
        margin-bottom: 20px;
        text-align: center;
      }
    
      
    
      /* Footer styling */
      footer {
        background-color: #000;
        text-align: center;
        padding: 20px;
        margin-top: 40px;
      }
    
      footer p {
        color: #fff;
      }
    
     
    
      @media (min-width: 769px) {
        .menu-icon {
          display: none;
        }
      }
    
      
    
      /* User food card styling */
      .userfoodcard {
        margin-top: 20px;
        height: 310px;
        width: 210px;
        border-radius: 10px;
        padding: 10px;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: white;
        margin-left: 30px;
      }
    
      .userfoodcard img {
        width: 100%;
        height: 36%;
        border-radius: 10px 10px 0 0;
        object-fit: cover;
      }
    
      .userdata {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        background-color: #222;
        padding: 10px 0px;
      }
    
      .userdata .category {
        font-size: smaller;
        width: 140px;
        margin-left: 8px;
        padding: 5px;
        text-align: center;
        border-radius: 20px;
        border: 2px solid rgb(6, 117, 8);
        color: rgb(248, 246, 246);
      }
    
      .userdata .likes {
        color: gainsboro;
        margin-right: 8px;
        margin-bottom: 10px;
      }
    
      .postdata {
        width: 100%;
        background-color: #222;
        padding: 10px 0px;
        border-radius: 0 0 10px 10px;
        text-align: center;
        height: 100px;
      }
    
      .postdata h2 {
        font-size: 18px;
        color: #32cd32;
        margin-bottom: 5px;
        margin-top: -14px;
      }
    
      .postdata .desc {
        font-size: 14px;
        line-height: 18px;
        color: #fff;
        margin-bottom: 5px;
        margin-left: 4px;
        margin-right: 4px;
      }
    
      .postdata a {
        color: #32cd32;
        text-decoration: none;
        transition: color 0.3s;
      }
    
      .postdata a:hover {
        color: #28a745;
      }
    
      /* Food show section styling */
      .foodshowsection {
        padding: 30px;
        display: flex;
        height: auto;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
      }
    
      @media (max-width: 480px) {
        
        .card{
          flex-direction: column;
         height: 250px;
          background: #000;
          justify-content: space-evenly;
         
        }
        .card img{
          height: 75px;
        }
        .card-title{
          font-size: 20px;
        }
        .card-name, .card-category, .card-country{
          font-size: 15px;
        }
        .card-a{
          margin-top: 10px;
        }
        .byuser{
          margin-top: 70px;
        }

       .countries .seemore{
        margin-top: 0px;
       }
       .foodshowsection{
        padding: 0px;
        gap: 10px;
        width:100%;
       
       }
       .userfoodcard{
        margin-left: 0px;
        font-size: small;
       padding: 2px;
       border: 3px solid #32cd32;
        justify-content: space-between;
        background: #222;
        height: 265px;
        width: 150px;
       }
       .userfoodcard p{
        font-size: smaller;
       }
       .userfoodcard .category{
        width: 145px;
        margin-left: 1px;
        font-size: x-small;
       }
       .userdata{
        gap: 6px;
       }
       .postdata .desc{
        font-size: 10px;
        line-height: 13px;
       }
        
      }
      header img{
        height: 50px;
       
        position: relative;
    
    }
    
   
    </style>
    
  </head>
  <body>
    <%- include("./header") %>

    <%- include("./partials/home/hero") %>

    <main>
      <h1 class="cuisines">Search by Cuisines</h1>
      <%- include("./partials/home/countries") %>


      <h1 class="cuisines" style="margin-top: 40px">Random Dish</h1>
      <%- include('partials/home/randomCard', { randomDish: randomDish }) %>

      <h1  class="byuser" style="color: #32cd32;text-align: center">
        Dish posted by users
      </h1>
      <div class="foodshowsection"></div>
    </main>

    <footer>
      <p>&copy; 2024 RecipeApp. All rights reserved.</p>
    </footer>

    <script>
    
      const menuIcon = document.querySelector(".menu-icon");
      const navLinks = document.querySelector(".nav-links");
  
      menuIcon.addEventListener("click", () => {
          navLinks.classList.toggle("mobile");
      });
  
      const foodshowsection = document.querySelector(".foodshowsection");
  
      window.addEventListener("load", async () => {
          console.log("Page loaded");
  
          try {
              // Fetch user posts
              const userPostsResponse = await fetch("https://reciperealm-1.onrender.com/allUserPost");
              const userPostsData = await userPostsResponse.json();
              console.log(userPostsData);
  
              userPostsData.forEach((post) => {
                  const content = `
                      <div class="userfoodcard">
                          <img  src="/images/uploads/${post.filename}" alt="${post.dishName}" />
                          <div class="userdata">
                              <p class="category">${post.dishCategory}</p>
                              <p class="likes"> ❤️ ${post.total_likes.length}Likes</p>
                          </div>
                          <div class="postdata">
                              <h2>${post.dishName}</h2>
                              <p class="desc">${post.dishDescription}</p>
                              <a href="/seeRecipe/${post._id}">See Recipe</a>
                          </div>
                      </div>`;
                  
                  foodshowsection.innerHTML += content;
              });
  
              // Call fetchContent() after posts are added to the DOM
              fetchContent();
          } catch (error) {
              console.error("Error fetching data:", error);
          }
      });
  
      const limitWords = (element, wordLimit) => {
          let text = element.innerText;
          let words = text.split(" ");
          if (words.length > wordLimit) {
              text = words.slice(0, wordLimit).join(" ") + "...";
              element.innerText = text;
          }
      };
  
      const fetchContent = () => {
          let desc = document.querySelectorAll(".desc");
          desc.forEach((child) => {
              limitWords(child, 10);
          });
      };
  </script>

  
  
  </body>
</html>
